(this.webpackJsonpstreamy=this.webpackJsonpstreamy||[]).push([[0],{241:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n(0),c=n.n(r),i=n(34),s=n.n(i),o=n(12),u=n(3),l=n(2),d=n(9),h=n(8),p=n(14),m=n(13),j=n(25),b=n.n(j),O=n(39),f=n(110),v=n.n(f).a.create({baseURL:"https://streamy-rest-api.herokuapp.com"}),y=n(19),x=Object(y.a)(),g="SIGN_IN",S="SIGN_OUT",E="CREATE_STREAM",N="DELETE_STREAM",k="EDIT_STREAM",I="FETCH_STREAM",w="FETCH_STREAMS",C=function(t){return function(){var e=Object(O.a)(b.a.mark((function e(n){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.get("/streams/".concat(t));case 2:a=e.sent,n({type:I,payload:a.data});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},A=n(24),D=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(t=e.call.apply(e,[this].concat(c))).adminEl=function(e){if(t.props.currentUserId===e.userId)return Object(a.jsxs)("div",{className:"right floated content",children:[Object(a.jsx)(A.a,{to:"/streams/edit/".concat(e.id),className:"ui button primary",children:"Edit"}),Object(a.jsx)(A.a,{to:"/streams/delete/".concat(e.id),className:"ui button negative",children:"Delete"})]})},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchStreams()}},{key:"streamListEL",value:function(){var t=this;return this.props.streams.map((function(e){return Object(a.jsxs)("div",{className:"item",children:[t.adminEl(e),Object(a.jsx)("i",{className:"large middle aligned icon camera"}),Object(a.jsxs)("div",{className:"content",children:[Object(a.jsx)(A.a,{to:"/streams/".concat(e.id),className:"header",children:e.title}),Object(a.jsx)("div",{className:"description",children:e.description})]})]},e.id)}))}},{key:"createStreamEl",value:function(){if(this.props.isSignedIn)return Object(a.jsx)("div",{style:{textAlign:"right"},children:Object(a.jsx)(A.a,{to:"/streams/new",className:"ui button primary",children:"Create Stream"})})}},{key:"render",value:function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{children:"Stream List"}),Object(a.jsx)("div",{className:"ui celled list",children:this.streamListEL()}),this.createStreamEl()]})}}]),n}(r.Component),T=Object(p.b)((function(t){return{currentUserId:t.auth.userId,isSignedIn:t.auth.isSignedIn,streams:Object.values(t.streams)}}),{fetchStreams:function(){return function(){var t=Object(O.a)(b.a.mark((function t(e){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.get("/streams");case 2:n=t.sent,e({type:w,payload:n.data});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})(D),_=n(243),M=n(242),R=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(t=e.call.apply(e,[this].concat(c))).inputEl=function(e){var n=e.input,r=e.label,c=e.meta,i="field ".concat(c.touched&&c.error?"error":null);return Object(a.jsxs)("div",{className:i,children:[Object(a.jsx)("label",{children:r}),Object(a.jsx)("input",Object(m.a)(Object(m.a)({},n),{},{autoComplete:"off"})),t.errorEl(c)]})},t.onSubmit=function(e){t.props.onSubmit(e)},t}return Object(l.a)(n,[{key:"errorEl",value:function(t){var e=t.touched,n=t.error;return e&&n?Object(a.jsx)("div",{className:"ui error message",children:Object(a.jsx)("div",{className:"header",children:n})}):null}},{key:"render",value:function(){return Object(a.jsxs)("form",{onSubmit:this.props.handleSubmit(this.onSubmit),className:"ui form error",children:[Object(a.jsx)(_.a,{name:"title",component:this.inputEl,label:"Enter Title"}),Object(a.jsx)(_.a,{name:"description",component:this.inputEl,label:"Enter Description"}),Object(a.jsx)("button",{className:"ui button primary",children:"Submit"})]})}}]),n}(r.Component),L=Object(M.a)({form:"streamForm",validate:function(t){var e={};return t.title||(e.title="You must enter a title"),t.description||(e.description="You must enter a description"),e}})(R),U=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(t=e.call.apply(e,[this].concat(r))).onSubmit=function(e){t.props.createStream(e)},t}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("h3",{children:"Create a Stream"}),Object(a.jsx)(L,{onSubmit:this.onSubmit})]})}}]),n}(r.Component),P=Object(p.b)(null,{createStream:function(t){return function(){var e=Object(O.a)(b.a.mark((function e(n,a){var r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a().auth.userId,e.next=3,v.post("/streams",Object(m.a)(Object(m.a)({},t),{},{userId:r}));case 3:c=e.sent,n({type:E,payload:c.data}),x.push("/");case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}})(U),B=n(47),F=n.n(B),G=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(t=e.call.apply(e,[this].concat(r))).onSubmit=function(e){t.props.editStream(t.props.match.params.id,e)},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchStream(this.props.match.params.id)}},{key:"render",value:function(){return this.props.stream?Object(a.jsxs)("div",{children:[Object(a.jsx)("h3",{children:"Edit Stream"}),Object(a.jsx)(L,{initialValues:F.a.pick(this.props.stream,"title","description"),onSubmit:this.onSubmit})]}):Object(a.jsx)("div",{children:"Loading.."})}}]),n}(r.Component),H=Object(p.b)((function(t,e){return{stream:t.streams[e.match.params.id]}}),{fetchStream:C,editStream:function(t,e){return function(){var n=Object(O.a)(b.a.mark((function n(a){var r;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.patch("/streams/".concat(t),e);case 2:r=n.sent,a({type:k,payload:r.data}),x.push("/");case 5:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()}})(G),J=function(t){return s.a.createPortal(Object(a.jsx)("div",{onClick:t.onDismiss,className:"ui dimmer modals visible active",children:Object(a.jsxs)("div",{onClick:function(t){return t.stopPropagation()},className:"ui standart modal visible active",children:[Object(a.jsx)("div",{className:"header",children:t.title}),Object(a.jsx)("div",{className:"content",children:t.content}),Object(a.jsx)("div",{className:"actions",children:t.actions})]})}),document.getElementById("modal"))},V=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(t=e.call.apply(e,[this].concat(r))).onDelete=function(){t.props.deleteStream(t.props.match.params.id)},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchStream(this.props.match.params.id)}},{key:"actions",value:function(){return Object(a.jsxs)(c.a.Fragment,{children:[Object(a.jsx)("button",{onClick:this.onDelete,className:"ui button negative",children:"Delete"}),Object(a.jsx)(A.a,{to:"/",className:"ui button",children:"Cancel"})]})}},{key:"contentText",value:function(){return this.props.stream?"Are you sure you want to ".concat(this.props.stream.title,"?"):"Are you sure you want to delete this stream"}},{key:"render",value:function(){return Object(a.jsx)(J,{title:"Delete Stream",content:this.contentText(),actions:this.actions(),onDismiss:function(){return x.push("/")}})}}]),n}(r.Component),X=Object(p.b)((function(t,e){return{stream:t.streams[e.match.params.id]}}),{fetchStream:C,deleteStream:function(t){return function(){var e=Object(O.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.delete("/streams/".concat(t));case 2:n({type:N,payload:t}),x.push("/");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})(V),Y=n(113),q=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(u.a)(this,n),(a=e.call(this,t)).videoRef=c.a.createRef(),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this.props.match.params.id;this.props.fetchStream(t),this.buildPlayer()}},{key:"componentDidUpdate",value:function(){this.buildPlayer()}},{key:"componentWillUnmount",value:function(){this.player.destroy()}},{key:"buildPlayer",value:function(){if(!this.player&&this.props.stream){var t=this.props.match.params.id;this.player=Y.a.createPlayer({type:"flv",url:"http://localhost:8000/live/".concat(t,".flv")}),this.player.attachMediaElement(this.videoRef.current),this.player.load()}}},{key:"render",value:function(){if(!this.props.stream)return Object(a.jsx)("div",{children:"Loading.."});var t=this.props.stream,e=t.title,n=t.description;return Object(a.jsxs)("div",{children:[Object(a.jsx)("video",{ref:this.videoRef,style:{width:"100%"},controls:!0}),Object(a.jsx)("h1",{children:e}),Object(a.jsx)("h5",{children:n})]})}}]),n}(r.Component),K=Object(p.b)((function(t,e){return{stream:t.streams[e.match.params.id]}}),{fetchStream:C})(q),W=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(t=e.call.apply(e,[this].concat(r))).onAuthChange=function(e){e?t.props.signIn(t.auth.currentUser.get().getId()):t.props.signOut()},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this;try{window.gapi.load("client:auth2",(function(){window.gapi.client.init({clientId:"1063489332108-l2ciheqvsh4atbgts2hr3g66c6ssacs9.apps.googleusercontent.com",scope:"email"}).then((function(){t.auth=window.gapi.auth2.getAuthInstance(),t.onAuthChange(t.auth.isSignedIn.get()),t.auth.isSignedIn.listen(t.onAuthChange)}))}))}catch(e){console.log(e)}}},{key:"AuthButtonEl",value:function(){var t=this;return null===this.props.isSignedIn?null:this.props.isSignedIn?Object(a.jsxs)("button",{className:"ui red google button",onClick:function(){return t.auth.signOut()},children:[Object(a.jsx)("i",{className:"google icon"}),"Sign Out"]}):Object(a.jsxs)("button",{className:"ui red google button",onClick:function(){return t.auth.signIn()},children:[Object(a.jsx)("i",{className:"google icon"}),"Sign In with Google"]})}},{key:"render",value:function(){return Object(a.jsx)("div",{children:this.AuthButtonEl()})}}]),n}(r.Component),z=Object(p.b)((function(t){return{isSignedIn:t.auth.isSignedIn}}),{signIn:function(t){return{type:g,payload:t}},signOut:function(){return{type:S}}})(W),Q=function(){return Object(a.jsxs)("div",{className:"ui secondary pointing menu",children:[Object(a.jsx)(A.a,{to:"/",className:"item",children:"Streamy"}),Object(a.jsxs)("div",{className:"right menu",children:[Object(a.jsx)(A.a,{to:"/",className:"item",children:"All Streams"}),Object(a.jsx)(z,{})]})]})},Z=function(){return Object(a.jsx)("div",{className:"ui container",children:Object(a.jsx)(o.b,{history:x,children:Object(a.jsxs)("div",{children:[Object(a.jsx)(Q,{}),Object(a.jsxs)(o.c,{children:[Object(a.jsx)(o.a,{path:"/",exact:!0,component:T}),Object(a.jsx)(o.a,{path:"/streams/new",exact:!0,component:P}),Object(a.jsx)(o.a,{path:"/streams/edit/:id",exact:!0,component:H}),Object(a.jsx)(o.a,{path:"/streams/delete/:id",exact:!0,component:X}),Object(a.jsx)(o.a,{path:"/streams/:id",exact:!0,component:K})]})]})})})},$=n(11),tt={isSignedIn:null,userId:null},et=n(38),nt=n(244),at=Object($.c)({auth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case g:return Object(m.a)(Object(m.a)({},t),{},{isSignedIn:!0,userId:e.payload});case S:return Object(m.a)(Object(m.a)({},t),{},{isSignedIn:!1,userId:null});default:return t}},form:nt.a,streams:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case I:case E:case k:return Object(m.a)(Object(m.a)({},t),{},Object(et.a)({},e.payload.id,e.payload));case N:return F.a.omit(t,e.payload);case w:return Object(m.a)(Object(m.a)({},t),F.a.mapKeys(e.payload,"id"));default:return t}}}),rt=n(112),ct=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||$.d,it=Object($.e)(at,ct(Object($.a)(rt.a)));s.a.render(Object(a.jsx)(p.a,{store:it,children:Object(a.jsx)(Z,{})}),document.getElementById("root"))}},[[241,1,2]]]);
//# sourceMappingURL=main.1e459ebb.chunk.js.map